# 실행 컨텍스트 스택
- 자바스크립트 엔진은 먼저 전역 코드를 평가한 후 전역 실행 컨텍스트를 생성한다
- 이후, 함수가 호출되면 함수 코드를 평가하여 실행 컨텍스트를 생성한다
- 이때, 생성된 실행 컨텍스트는 스택으로 관리하고, 이를 실행 컨텍스트 스택이라고 부른다

```typescript jsx
const x = 1;

function foo () {
	const y = 2;
	
	function bar () {
		const z = 3;
		console.log(x + y + z)
  }
	
	bar()
}

foo() // 6
```

## 1) 전역 코드의 평가와 실행
- 자바스크립트 엔진은 전역 코드를 평가하여 전역 실행 컨텍스트를 생성한다
  - 생성된 실행 컨텍스트를 실행 컨텍스트 스택에 push 한다
  - 전역 변수 x, 전역 함수 foo 가 이 실행 컨텍스트에 저장된다
- 저장까지 완료되면 실행을 시작한다
- 전역 변수 x 에 값이 할당되고 전역 함수 foo 가 호출된다

## 2) foo 함수 코드의 평가와 실행
- foo 가 호출되면서 전역 코드의 실행은 일시 중지되고 코드의 제어권이 foo 함수 안으로 들어간다
  - foo 함수 내부 코드를 평가하고 foo 함수 실행 컨텍스트를 생성한 후 실행 컨텍스트 스택에 push 한다
  - foo 함수 안에 있는 지역 변수 y 와 함수 bar 도 foo 함수 실행 컨텍스트에 등록된다
- 저장이 완료되면 실행을 시작한다
- 지역 변수 y 에 값이 할당하고 중첩함수 bar 가 호출된다

## 3) bar 함수 코드의 평가와 실행
- 중첩 함수 bar 가 호출되면 foo 함수 코드의 실행은 일시 중단되고 코드의 제어권이 bar 함수 안으로 이동한다
  - 자바스크립트 엔진은 bar 함수 내부 코드를 평가하고 실행 컨텍스트를 생성해 실행 컨텍스트 스택에 push 한다
  - bar 함수의 지역 변수 z 가 bar 함수 실행 컨텍스트에 등록된다
- 저장이 완료되면 실행을 시작한다
- 지역 변수 z 에 값이 할당되고 console.log 메서드를 호출한다
- bar 함수가 종료된다

## 4) foo 함수로 복귀
- bar 함수가 종료되면 제어권이 다시 foo 함수로 이동한다
- 자바스크립트 엔진은 bar 함수 실행 컨텍스트를 실행 컨텍스트의 스택에서 pop 하여 제거한다
- foo 함수는 더 이상 실행할 코드가 없으므로 종료된다

## 5) 전역 코드로 복귀
- foo 함수가 종료되면 코드의 제어권이 전역 코드로 이동한다
- 자바스크립트 엔진은 foo 함수 실행 컨텍스트를 실행 컨텍스트 스택에서 pop 하여 제거한다
- 전역 코드가 남아 있지 않으므로 전역 실행 컨텍스트도 실행 컨텍스트 스택에서 pop 된다

### 실행중인 실행 컨텍스트
- 실행 컨텍스트는 코드의 실행 순서를 관리한다
- 실행 컨텍스트 스택의 최상위에 존재하는 실행 컨텍스트는 언제나 현재 실행 중인 코드의 실행 컨텍스트다
- 즉, 실행 컨텍스트 스택의 최상위에 존재하는 실행컨텍스트를 실행 중인 실행 컨텍스트라 한다