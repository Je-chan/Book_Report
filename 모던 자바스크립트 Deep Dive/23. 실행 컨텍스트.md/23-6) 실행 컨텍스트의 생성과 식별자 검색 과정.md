# 실행 컨텍스트의 생성과 식별자 검색 과정
```typescript jsx
var x = 1;
const y = 2;

function foo(a) {
	var x = 3;
	const y = 4;
	
	function bar(b) {
		const z = 5;
		console.log(a + b + x + y + z)
  }
	
	bar(10)
}

foo(20) // 42
```
## 1) 전역 객체 생성
- 전역 객체는 전역 코드가 평가되기 이전에 생성된다
- 전역 객체도 Object.prototype 을 상속 받는다.
  - 즉, 전역 객체도 프로토타입 체인의 일원

## 2) 전역 코드 평가
- 소스코드가 로드되면 자바스크립트 엔진이 전역 코드를 평가한다

### 2-1) 전역 실행 컨텍스트 생성
- 비어있는 전역 실행 컨텍스트를 생성하고 실행 컨텍스트 스택에 push 한다
- 이때의 실행 컨텍스트는 실행중이다

### 2-2) 전역 렉시컬 환경 생성
- 전역 렉시컬 환경을 생성하고 전역 실행컨텍스트에 바인딩한다
1. 전역 환경 레코드 생성 
   - 전역 환경 레코드는 전역 변수를 관리하는 전역 스코프, 전역 객체의 빌트인 전역 프로퍼티, 빌트인 전역함수, 표준 빌트인 객체를 제공한다
   - var 키워드로 선언한 전역 변수와 let, const 키워드로 선언한 전역 변수는 구분이 필요하다
   - 이를 위해 전역 환경 레코드는 객체 환경 레코드와 선언적 환경 레코드로 분리한다
   1. 객체 환경 레코드
      - var 키워드로 선언한 전역 변수, 함수 선언문으로 정의된 전역 함수
      - 전역 환경 레코드의 객체 환경 레코드에 연결된 BindingObject 를 통해 전역 객체의 프로퍼티와 메서드가 된다
   2. 선언적 환경 레코드
      - 객체 환경 레코드로 들어가는 것 이외의 것들(let, const 키워드 사용한 전역 변수나 함수 선언문 이외의 다른 방법으로 정의한 전역 함수 등)
      - 위의 내용들이 선언전 환경 레코드에 등록되고 관리된다
        - let, const 가 개념적인 블록 내에 존재한다고 했을 때 개념적인 블록이 바로 이 레코드
      - 전역 객체의 프로퍼티가 되지 않는다
      - 선언 단계, 초기화 단계가 분리되어 일시적 사각지대에 존재하게 된다
2. this 바인딩
   - 전역 환경 레코드 [[GlobalThisValue]] 내부 슬롯에 this 가 바인딩된다
   - 전역 코드에서 this 를 참조하면 전역 환경 레코드 [[GlobalThisValue]] 내부 슬롯에 바인딩된 객체가 반환된다
3. 외부 렉시컬 환경에 대한 참조 결정
   - 즉, 상위 스코프를 결정한다는 의미다
   - 단방향 링크드 리스트인 스코프체인을 구현한다
